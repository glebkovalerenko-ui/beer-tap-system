# Admin App Audit (UX/QX/QI, логика, функциональность)

Дата: 2026-02-17

## 1) Executive summary

Текущее состояние `admin-app` можно довести до презентационного уровня, но сейчас продукт страдает от разрыва между «доказательностью платформы» и «визуально-интуитивным опытом менеджера бара».

Ключевой вывод: приложение уже имеет рабочую основу (дашборд, гости, краны/кеги, NFC, emergency stop), но не хватает:
- продуктовой структуры «метрики → действие → результат»;
- демонстрационного сценария для инвестора/владельца;
- унификации UX-паттернов и снижения «технической шероховатости».

## 2) Что уже хорошо (сильные стороны)

1. **Сценарные модули выделены доменно**: `Dashboard`, `Guests`, `TapsKegs`, отдельные stores на сущности. 
2. **Есть живые операционные фичи**: emergency stop, мониторинг наливов, управление кегами/кранами, пополнение баланса, NFC-слой. 
3. **Поддерживается desktop bridge через Tauri** для NFC и API-команд.

## 3) Реестр несостыковок и недочетов

| ID | Серьезность | Тип | Симптом | Доказательство | Рекомендация |
|---|---|---|---|---|---|
| A-01 | S1 | UX/QI | Во многих user-flow используются `alert/confirm`, что разрушает «премиальный» UX и выглядит как dev-прототип. | `Guests.svelte`, `TapsKegs.svelte`, `TapCard.svelte` содержат `alert(...)`/`confirm(...)`. | Вынести единый `Notification/Confirm service` + дизайн-системные toast/modal паттерны. |
| A-02 | S1 | Product UX | Нет явной «бизнес-панели руководителя» (выручка, оборачиваемость кег, аномалии, SLA), только операционные экраны. | `Dashboard.svelte` фокусируется на статусах и ленте, без KPI-виджетов и трендов. | Добавить блок KPI: выручка сегодня, наливы/час, маржинальность, прогноз empty kegs. |
| A-03 | S1 | Demo readiness | Нет «guided demo mode» для презентации инвестору/владельцу. | Нет маршрута/компонента demo walkthrough в `routes/*`. | Ввести режим презентации: сценарий из 4–5 шагов с подсветкой ценности. |
| A-04 | S2 | Логика/архитектура | Много логики initial-load в маршрутах, риск рассинхронизации и дублирования загрузок. | `Dashboard.svelte`, `Guests.svelte`, `TapsKegs.svelte` используют реактивные блоки и локальные флаги загрузки. | Централизовать bootstrap данных в app-level orchestrator/store. |
| A-05 | S2 | UX | Избыточные `console.log` в production-path ухудшают сигнал/шум и затрудняют диагностику. | `App.svelte`, `TapsKegs.svelte`, `Guests.svelte`, stores. | Перейти на уровни логирования + выключение debug-логов в production. |
| A-06 | S2 | Accessibility | Ряд интерактивных зон были не полностью a11y-friendly (mouse-first паттерны). | warning от Svelte по modal backdrop и click-events. | Стандартизировать keyboard/focus/aria для всех модалок и action controls. |
| A-07 | S2 | Надежность demo | До правки логин был привязан к Tauri-path, web-demo сценарий менее устойчив. | `Login.svelte` использовал только `invoke('login')`. | Поддерживать fallback HTTP-авторизацию для browser demo (выполнено). |
| A-08 | S3 | QI/копирайтинг | Тексты UI местами технические, а не продуктовые (мало value framing для владельца бара). | Кнопки/секции в `Dashboard.svelte`, `TapsKegs.svelte` ориентированы на операторские действия. | Переписать микрокопию: «что получит бизнес» и «что делать дальше». |
| A-09 | S3 | Визуальная консистентность | Нет формализованной дизайн-системы (цвета, токены, типографика, spacing). | Стили разбросаны по Svelte-компонентам, локальные palette/button rules. | Ввести `tokens.css` + унифицированные UI primitives. |
| A-10 | S3 | Функционал | Нет role-based UX (владелец/менеджер/бармен) и контекстных разрешений в интерфейсе. | Навигация и действия едины для всех; отсутствует role-aware rendering. | Добавить роли и профильные дашборды/ограничения действий. |

## 4) Приоритетный план улучшений

### Этап 1 (1–3 дня): «визуальная и поведенческая гигиена»
1. Убрать `alert/confirm` и заменить на единый модальный/уведомительный слой.
2. Привести все критичные интеракции к a11y-минимуму.
3. Стабилизировать demo-path: web + tauri без скрытых предположений.

### Этап 2 (1 неделя): «инвесторский экран ценности»
1. Новый dashboard с KPI-картами и трендами.
2. Раздел «Операционные риски» (кеги на исходе, отключенные краны, ошибки NFC/API).
3. Экран «бизнес-эффект» (условная экономия времени/ошибок, выручка/смена).

### Этап 3 (2–4 недели): «продуктовая зрелость»
1. Дизайн-система и UI-kit (компоненты + токены).
2. Guided demo mode + demo data seeding.
3. Role-based интерфейс + аудит действий на уровне UI.

## 5) Внесенные в этом PR быстрые улучшения

1. Логин стал устойчивее для презентаций: добавлен fallback web-auth (`POST /api/token`) если Tauri invoke недоступен.
2. Улучшена доступность модалки (keyboard semantics на backdrop).
3. На дашборде добавлен явный заголовок ленты наливов (исправляет UX/структуру правой панели).

## 6) Риски и что проверить перед демо

- Проверить единый backend URL/конфиг, чтобы web-demo и tauri-demo не расходились.
- Проверить поведение при потерях сети (ошибки должны быть в UI-дружелюбном виде, без системных alert).
- Прогнать презентационный сценарий «новый гость → пополнение → налив → аналитика» без ручных обходов.

## 7) Статус выполнения Этапа 1 (визуальная и поведенческая гигиена)

Реализовано в коде:
1. **Унифицированный UX-слой уведомлений и подтверждений**
   - Добавлен `uiStore` с toast-уведомлениями и promise-based confirm API.
   - В `App.svelte` подключены глобальные `ToastContainer` и `ConfirmDialog`.
   - Критичные сценарии (`TapsKegs`, `TapCard`, `Guests`, `Dashboard`) переведены с `alert/confirm` на единый UX-механизм.

2. **A11y-гигиена модального взаимодействия**
   - Подтверждающие диалоги теперь идут через единый modal-flow.
   - Для модального backdrop добавлена явная keyboard-обработка и ARIA-атрибуты.

3. **Стабильность demo-path**
   - Логин сохраняет Tauri-first поведение, но имеет устойчивый HTTP fallback.
   - Вынесен конфиг API base URL (`VITE_API_BASE_URL`) для предсказуемого поведения в web-demo и tauri-demo.

Оставшиеся задачи Этапа 1 (следующий PR этого же этапа, если потребуется):
- системно убрать debug-логи из production-path;
- унифицировать обработку ошибок в stores через `uiStore` (а не точечно в компонентах);
- добавить e2e smoke-сценарий кликабельного demo-flow (login -> taps -> guests).
