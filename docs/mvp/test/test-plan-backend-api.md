# –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API: Backend API (v1.0.0)

## 1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 1.1. –¶–µ–ª—å –¥–æ–∫—É–º–µ–Ω—Ç–∞
–ù–∞—Å—Ç–æ—è—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–∞–≤–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è `Backend API` –ø—Ä–æ–µ–∫—Ç–∞ **Beer Tap System**. –ï–≥–æ —Ü–µ–ª—å ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API. –î–æ–∫—É–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –±—ç–∫–ª–æ–≥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–µ–º–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á.

### 1.2. –û–±—ä–µ–∫—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
*   **–û—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç:** `Backend API` (FastAPI/Python).
*   **–ì—Ä–∞–Ω–∏—Ü—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–æ—É—Ç–∏–Ω–≥, –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö).
    *   –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª.
    *   –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ SQLAlchemy).
    *   –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤—ã–¥–∞—á–∞ JWT) –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–∑–∞—â–∏—Ç–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤).

### 1.3. –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
*   **–°—Ä–µ–¥–∞:** –õ–æ–∫–∞–ª—å–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ `docker-compose` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤: –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è SQLite –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (`conftest.py`).
    *   –î–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: –ß–∏—Å—Ç—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä PostgreSQL, —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–π —á–µ—Ä–µ–∑ `docker-compose`.
*   **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
    *   **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** `pytest` —Å –ø–ª–∞–≥–∏–Ω–æ–º `pytest-bdd`.
    *   **–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Postman, Insomnia, –∏–ª–∏ `cURL`.

### 1.4. –õ–µ–≥–µ–Ω–¥–∞ –∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é
–≠—Ç–æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–º. –í —Ö–æ–¥–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ QA-–∏–Ω–∂–µ–Ω–µ—Ä –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è.

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **–°—Ç–∞—Ç—É—Å** | `[ ]` To Do, `[‚úÖ]` Pass, `[‚ùå]` Fail, `[‚ö†Ô∏è]` Blocked |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | `P1` (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π), `P2` (–í—ã—Å–æ–∫–∏–π), `P3` (–°—Ä–µ–¥–Ω–∏–π) |
| **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω?** | `[‚úÖ]` –î–∞, `[ ]` –ù–µ—Ç. –ü–æ–ª–µ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ –¥–∞–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π. |
| **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID**| ID –∑–∞–¥–∞—á–∏ –∏–∑ —Ç—Ä–µ–∫–µ—Ä–∞ (Jira, GitHub Issues), –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏, `cURL` –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è. |

### 1.5. –û–±—â–∞—è –∫–∞—Ä—Ç–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è (Mind Map)
```mermaid
mindmap
  root((Backend API Test Plan))
    (Module 1: Security & Auth)
      ::icon(fa fa-lock)
      Feature: Token Management
        - Get Token (Success/Fail)
        - Validate Token
      Feature: Endpoint Protection
        - Access with valid token
        - Access without token
        - Access with invalid token
      Feature: Audit Logging
        - Log on write actions (POST/PUT/DELETE)
        - Ignore on read actions (GET)
    (Module 2: Guest & Finance)
      ::icon(fa fa-user-check)
      Feature: Guest CRUD
        - Create, Read, Update
        - Uniqueness validation (phone, doc)
      Feature: Card Management
        - Bind new/existing card
        - Unbind card
        - Prevent binding taken card
      Feature: Financial Operations
        - Top-up balance
        - Validate amount
        - View history (pours & top-ups)
    (Module 3: Inventory & Taps)
      ::icon(fa fa-boxes)
      Feature: Beverage Directory
        - CRUD for beverages
        - Uniqueness validation (name)
      Feature: Keg Inventory
        - CRUD for kegs
        - Prevent deleting 'in_use' keg
      Feature: Tap Management
        - Assign Keg to Tap
        - Unassign Keg from Tap
        - Business rule validation (statuses)
    (Module 4: Controller Interaction)
      ::icon(fa fa-broadcast-tower)
      Feature: Controller Check-in
        - Register new controller (Upsert)
        - Update existing controller
      Feature: System Status Sync
        - Get 'Emergency Stop' status
      Feature: Pour Data Sync
        - Process valid pour (Happy Path)
        - Handle duplicates (Idempotency)
        - Reject invalid pours (balance, status)
```

### 1.6. –°–∫–≤–æ–∑–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π "Happy Path" (Sequence Diagram)
```mermaid
sequenceDiagram
    actor Bartender
    participant AdminApp as Admin App (UI)
    participant BackendAPI as Backend API
    participant Database as PostgreSQL DB

    Note over Bartender, Database: –°—Ü–µ–Ω–∞—Ä–∏–π: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è

    Bartender->>AdminApp: 1. –í–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è
    AdminApp->>BackendAPI: 2. POST /api/guests/
    note right of AdminApp: (Sends JWT in header)
    BackendAPI->>Database: 3. INSERT into guests
    Database-->>BackendAPI: Guest Record
    BackendAPI-->>AdminApp: 201 Created (Guest Object)
    AdminApp-->>Bartender: 4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–æ—Å—Ç—è –≤ —Å–ø–∏—Å–∫–µ

    Bartender->>AdminApp: 5. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
    AdminApp->>BackendAPI: 6. POST /api/guests/{id}/topup
    BackendAPI->>Database: 7. START TRANSACTION
    Database->>BackendAPI: SELECT guest for update
    BackendAPI->>Database: 8. INSERT into transactions (amount)
    BackendAPI->>Database: 9. UPDATE guests SET balance = ...
    Database->>BackendAPI: COMMIT
    BackendAPI-->>AdminApp: 200 OK (Updated Guest Object)
    AdminApp-->>Bartender: 10. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å –≤ UI
```

### 1.7. –ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞ (Flowchart)
```mermaid
graph TD
    A[Start: –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω] --> B{–í—ã–±–æ—Ä —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞};
    
    subgraph "–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Postman / cURL)"
        direction LR
        C[1. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—é] --> D{–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É?};
        D -- –î–∞ --> E[‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ 'Pass'];
        D -- –ù–µ—Ç --> F[‚ùå –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ 'Fail'];
        F --> G[2. –ó–∞–≤–µ—Å—Ç–∏ –±–∞–≥ –≤ —Ç—Ä–µ–∫–µ—Ä–µ];
        G --> H[3. –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å Bug ID –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—é];
    end

    subgraph "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Pytest-BDD)"
        direction LR
        I[1. –ù–∞–ø–∏—Å–∞–Ω–∏–µ feature-—Ñ–∞–π–ª–∞ –Ω–∞ Gherkin] --> J[2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∞–≥–æ–≤ –≤ Python];
        J --> K[3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ CI/CD];
        K --> L{–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏?};
        L -- –î–∞ --> M[‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω'];
        L -- –ù–µ—Ç --> N[üö® CI/CD Build 'Failed'];
    end

    B --> C;
    E --> P[–ì–æ—Ç–æ–≤ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏];
    P --> I;

    style A fill:#c9f,stroke:#333,stroke-width:2px
    style M fill:#dfd,stroke:#333,stroke-width:2px
    style N fill:#fdd,stroke:#333,stroke-width:2px
```

---

## 2. –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

### –ú–æ–¥—É–ª—å 1: Security & Auth

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-SEC-01| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br>**Given** –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ username="admin" –∏ password="fake_password"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 200 OK<br>**And** –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å "access_token" –∏ "token_type" | |
| TC-API-SEC-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request<br>**And** –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—à–∏–±–∫—É "Incorrect username or password" | |
| TC-API-SEC-03| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å –Ω–µ–≤–µ—Ä–Ω—ã–º username<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request | |
| TC-API-SEC-04| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –±–µ–∑ –ø–æ–ª—è password<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token –±–µ–∑ –ø–æ–ª—è "password"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-SEC-05| P3 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º Content-Type<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å JSON-—Ç–µ–ª–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-SEC-06| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 200 OK | |
| TC-API-SEC-07| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É –±–µ–∑ —Ç–æ–∫–µ–Ω–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 401 Unauthorized | |
| TC-API-SEC-08| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 401 Unauthorized | |
| TC-API-SEC-09| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å —Ç–æ–∫–µ–Ω–æ–º, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –Ω–µ–≤–µ—Ä–Ω—ã–º –∫–ª—é—á–æ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å —Ç–æ–∫–µ–Ω–æ–º, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –¥—Ä—É–≥–∏–º –∫–ª—é—á–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 401 Unauthorized | |
| TC-API-SEC-10| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –∂—É—Ä–Ω–∞–ª–µ –∞—É–¥–∏—Ç–∞<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "audit_logs" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-SEC-11| P2 | `[ ]` | `[ ]` | **Scenario:** –ê—É–¥–∏—Ç –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–ª—è GET-–∑–∞–ø—Ä–æ—Å–æ–≤<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/<br>**Then** –í —Ç–∞–±–ª–∏—Ü–µ "audit_logs" –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π | |
| TC-API-SEC-12| P1 | `[ ]` | `[ ]` | **Scenario:** –ê—É–¥–∏—Ç –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ<br>**Given** –ö–ª–∏–µ–Ω—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/<br>**Then** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "audit_logs" –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π | |

### –ú–æ–¥—É–ª—å 2: Guest & Finance Management

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-GST-01| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –≤–∞–ª–∏–¥–Ω—ã–º JSON-—Ç–µ–ª–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 201 Created<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "guests" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-GST-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Å—Ç—è —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º "+79991112233"<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è —Å —Ç–µ–º –∂–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-GST-03| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Å—Ç—è —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–º<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º "4510 123456"<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è —Å —Ç–µ–º –∂–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-GST-04| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Å—Ç—è –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ –±–µ–∑ –ø–æ–ª—è "last_name"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-GST-05| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Å—Ç—è<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å "–ò–≤–∞–Ω–æ–≤"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PUT-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id} —Å –Ω–æ–≤—ã–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –ó–∞–ø–∏—Å—å –≤ –ë–î –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ | |
| TC-API-GST-06| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç—ã –∫ –≥–æ—Å—Ç—é<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å "–ü–µ—Ç—Ä–æ–≤"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/cards —Å –Ω–æ–≤—ã–º "card_uid"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "cards" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "active" | |
| TC-API-GST-07| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏–≤—è–∑–∞—Ç—å —É–∂–µ –∑–∞–Ω—è—Ç—É—é –∫–∞—Ä—Ç—É<br>**Given** –ö–∞—Ä—Ç–∞ "TAKEN-UID-456" –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –¥—Ä—É–≥–æ–º—É –≥–æ—Å—Ç—é<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–≤—è–∑–∞—Ç—å —ç—Ç—É –∫–∞—Ä—Ç—É –∫ –Ω–æ–≤–æ–º—É –≥–æ—Å—Ç—é<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-GST-08| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –æ—Ç–≤—è–∑—ã–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –æ—Ç –≥–æ—Å—Ç—è<br>**Given** –ö–∞—Ä—Ç–∞ "ACTIVE-UID-789" –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –≥–æ—Å—Ç—é<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/cards/{card_uid}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –°—Ç–∞—Ç—É—Å –∫–∞—Ä—Ç—ã –≤ –ë–î –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "inactive" | |
| TC-API-GST-09| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≥–æ—Å—Ç—è<br>**Given** –ì–æ—Å—Ç—å "–°–º–∏—Ä–Ω–æ–≤" –∏–º–µ–µ—Ç –±–∞–ª–∞–Ω—Å "100.00"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/topup —Å —Å—É–º–º–æ–π 500.00<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –ë–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è –≤ –ë–î –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "600.00"<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "transactions" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-GST-10| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —Å—É–º–º—É<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/topup —Å —Å—É–º–º–æ–π -100.00<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-GST-11| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –≥–æ—Å—Ç—é<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_uuid}/topup<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 404 Not Found | |
| TC-API-GST-12| P2 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–º–µ—à–∞–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π<br>**Given** –£ –≥–æ—Å—Ç—è –µ—Å—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –Ω–∞–ª–∏–≤<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/history<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ –¥–≤—É—Ö –æ–ø–µ—Ä–∞—Ü–∏–π | |

### –ú–æ–¥—É–ª—å 3: Inventory & Tap Management

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-INV-01| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –Ω–∞–ø–∏—Ç–∫–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/beverages/ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "beverages" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-INV-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–ø–∏—Ç–∫–∞ —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–∞–ø–∏—Ç–æ–∫ —Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request | |
| TC-API-INV-03| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–µ–≥–∏<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞–ø–∏—Ç–æ–∫ "Lager"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ "Lager"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "full" | |
| TC-API-INV-04| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –∫–µ–≥—É —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –Ω–∞–ø–∏—Ç–∫–æ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º beverage_id<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 404 Not Found | |
| TC-API-INV-05| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –∫–µ–≥—É<br>**Given** –ö–µ–≥–∞ {keg_id} –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "in_use"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/{keg_id}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-INV-06| P2 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∫–µ–≥–∏<br>**Given** –ö–µ–≥–∞ {keg_id} –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "full"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/{keg_id}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 204 No Content | |
| TC-API-INV-07| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫—Ä–∞–Ω–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/ —Å display_name<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –°—Ç–∞—Ç—É—Å –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "locked" | |
| TC-API-INV-08| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –∫—Ä–∞–Ω —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–π –∫–µ–≥–æ–π<br>**Given** –ö –∫—Ä–∞–Ω—É {tap_id} –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫–µ–≥–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/{tap_id}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request | |
| TC-API-INV-09| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–µ–≥–∏ –Ω–∞ –∫—Ä–∞–Ω<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –∫–µ–≥–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "full" –∏ –∫—Ä–∞–Ω —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "locked"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PUT-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/{tap_id}/keg —Å id –∫–µ–≥–∏<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –°—Ç–∞—Ç—É—Å –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "active"<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "in_use" | |
| TC-API-INV-10| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∫–µ–≥—É –Ω–∞ –∑–∞–Ω—è—Ç—ã–π –∫—Ä–∞–Ω<br>**Given** –ö—Ä–∞–Ω {tap_id} —É–∂–µ –∑–∞–Ω—è—Ç<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–∞ –Ω–µ–≥–æ –¥—Ä—É–≥—É—é –∫–µ–≥—É<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-INV-11| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–µ–ø–æ–ª–Ω—É—é –∫–µ–≥—É –Ω–∞ –∫—Ä–∞–Ω<br>**Given** –ö–µ–≥–∞ {keg_id} –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "in_use" –∏–ª–∏ "empty"<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å —ç—Ç—É –∫–µ–≥—É –Ω–∞ –∫—Ä–∞–Ω<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-INV-12| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–Ω—è—Ç–∏–µ –∫–µ–≥–∏ —Å –∫—Ä–∞–Ω–∞<br>**Given** –ö –∫—Ä–∞–Ω—É {tap_id} –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫–µ–≥–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/{tap_id}/keg<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –°—Ç–∞—Ç—É—Å –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "locked"<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "full" | |

### –ú–æ–¥—É–ª—å 4: Controller Interaction

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-CTL-01| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–µ—Ä–≤–∏—á–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/controllers/register —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º "controller_id"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "controllers" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-CTL-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–π "check-in" —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞<br>**Given** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä "RPi-001" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä "RPi-001" –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/controllers/register —Å –Ω–æ–≤—ã–º IP<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –ó–∞–ø–∏—Å—å –≤ –ë–î –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ | |
| TC-API-CTL-03| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "Emergency Stop –í–´–ö–õ–Æ–ß–ï–ù"<br>**Given** –§–ª–∞–≥ "emergency_stop_enabled" —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ "false"<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/system/status<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å `{"value": "false"}` | |
| TC-API-CTL-04| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "Emergency Stop –í–ö–õ–Æ–ß–ï–ù"<br>**Given** –§–ª–∞–≥ "emergency_stop_enabled" —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ "true"<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/system/status<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å `{"value": "true"}` | |
| TC-API-CTL-05| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω–æ–≥–æ –Ω–∞–ª–∏–≤–∞<br>**Given** –ì–æ—Å—Ç—å –∏–º–µ–µ—Ç –±–∞–ª–∞–Ω—Å, –∫—Ä–∞–Ω –∏ –∫–µ–≥–∞ –∞–∫—Ç–∏–≤–Ω—ã<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/sync/pours/ —Å –≤–∞–ª–∏–¥–Ω—ã–º –Ω–∞–ª–∏–≤–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "accepted"<br>**And** –ë–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è –∏ –æ—Å—Ç–∞—Ç–æ–∫ –≤ –∫–µ–≥–µ –¥–æ–ª–∂–Ω—ã —É–º–µ–Ω—å—à–∏—Ç—å—Å—è | |
| TC-API-CTL-06| P1 | `[ ]` | `[ ]` | **Scenario:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏: –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ª–∏–≤–∞<br>**Given** –ù–∞–ª–∏–≤ —Å `client_tx_id="DUPLICATE-TX-ID"` —É–∂–µ –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ—Ç –∂–µ –Ω–∞–ª–∏–≤<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "accepted" –∏ reason "duplicate"<br>**And** –ë–∞–ª–∞–Ω—Å –∏ –æ—Å—Ç–∞—Ç–æ–∫ –ù–ï –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω–∏—Ç—å—Å—è | |
| TC-API-CTL-07| P1 | `[ ]` | `[ ]` | **Scenario:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–ª–∏–≤–∞ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞<br>**Given** –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞–ª–∏–≤–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –±–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ—Ç –Ω–∞–ª–∏–≤<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "rejected" –∏ reason "Insufficient funds" | |
| TC-API-CTL-08| P2 | `[ ]` | `[ ]` | **Scenario:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–ª–∏–≤–∞ –∏–∑-–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä–∞–Ω–∞<br>**Given** –ö—Ä–∞–Ω –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "locked"<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ª–∏–≤ —Å —ç—Ç–æ–≥–æ –∫—Ä–∞–Ω–∞<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "rejected" | |
| TC-API-CTL-09| P2 | `[ ]` | `[ ]` | **Scenario:** –ù–∞–ª–∏–≤, –æ–ø—É—Å—Ç–æ—à–∞—é—â–∏–π –∫–µ–≥—É<br>**Given** –û—Å—Ç–∞—Ç–æ–∫ –≤ –∫–µ–≥–µ —Ä–∞–≤–µ–Ω –æ–±—ä–µ–º—É –Ω–∞–ª–∏–≤–∞<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ—Ç –Ω–∞–ª–∏–≤<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "accepted"<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –∏ –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ "empty" | |

---

## 3. –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ (Summary)

### 3.1. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –°—Ç–∞—Ç—É—Å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| :--- | :--- |
| ‚úÖ Pass | |
| ‚ùå Fail | |
| ‚ö†Ô∏è Blocked | |
| **–í—Å–µ–≥–æ** | |
| **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ** | |

### 3.1.1. –§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—á–µ—Ç –æ –ö–∞—á–µ—Å—Ç–≤–µ API –∏ –ü—Ä–æ–≥—Ä–µ—Å—Å–µ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (P1)**

**–ü—Ä–æ–µ–∫—Ç:** Beer Tap System MVP v1.0
**–û–±—ä–µ–∫—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Backend API
**–î–∞—Ç–∞:** 6 –Ω–æ—è–±—Ä—è 2025 –≥.
**–¢–∏–ø –ø—Ä–æ–≥–æ–Ω–∞:** –ü–æ–ª–Ω—ã–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (P1 BDD-—Å—Ü–µ–Ω–∞—Ä–∏–∏ + —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã).

#### **1. –ò—Ç–æ–≥–æ–≤–∞—è –°–≤–æ–¥–∫–∞ (Executive Summary)**

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö (P1) —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏–∑ —Ç–µ—Å—Ç-–ø–ª–∞–Ω–∞ `test-plan-backend-api.md` —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –°–æ–∑–¥–∞–Ω–Ω—ã–π –Ω–∞ –±–∞–∑–µ `pytest-bdd` —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø–æ–∫–∞–∑–∞–ª —Å–≤–æ—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø–æ–∑–≤–æ–ª–∏–≤ –ø–æ–∫—Ä—ã—Ç—å 100% P1-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ –≤—ã—è–≤–∏—Ç—å **—Ç—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–∞**, –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –∫–ª—é—á–µ–≤—É—é –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≥–æ–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —è–¥—Ä–æ API (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –±–∞–∑–æ–≤—ã–µ CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤) –≤ —Ü–µ–ª–æ–º **—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º**. –í—Å–µ —Ç–µ—Å—Ç—ã, –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –±–∞–≥–∞–º–∏, —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥—è—Ç.

–†–∞–±–æ—Ç–∞ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª–∏–ª–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –∏ –≤—ã—è–≤–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (`BUG-SEC-001`), –∞ —Ç–∞–∫–∂–µ –Ω–∞–π—Ç–∏ –¥–µ—Ñ–µ–∫—Ç—ã-–æ–ø–µ—á–∞—Ç–∫–∏ (`BUG-GST-001`) –∏ –æ—à–∏–±–∫–∏ –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ (`BUG-CTL-001`), –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–æ –±—ã —Å–ª–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–∏ —Ä—É—á–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

#### **2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è**

| –°—Ç–∞—Ç—É—Å | BDD-—Ç–µ—Å—Ç—ã (P1) | –î—Ä—É–≥–∏–µ —Ç–µ—Å—Ç—ã | **–í—Å–µ–≥–æ** |
| :--- | :--- | :--- | :--- |
| ‚úÖ **Passed** | 27 | 3 | **30** |
| ‚ö†Ô∏è **Skipped** | 4 | 0 | **4** |
| ‚ùå **Failed** | 0 | 0 | **0** |
| **–í—Å–µ–≥–æ** | **31** | **3** | **34** |

**–í—ã–≤–æ–¥:** –¢–µ–∫—É—â–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é "–∑–µ–ª–µ–Ω—ã–π". –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`skipped`) –∏–∑–æ–ª–∏—Ä—É—é—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–≥–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —á–∏—Å—Ç–æ—Ç—É CI/CD-–ø—Ä–æ–≥–æ–Ω–æ–≤.

#### **3. –ö–ª—é—á–µ–≤—ã–µ –ù–∞—Ö–æ–¥–∫–∏ (Bugs & Issues)**

–í —Ö–æ–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã:

1.  **`BUG-SEC-001` (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π, –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π):** –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (–∞—É–¥–∏—Ç) –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ—Å—Ç–æ–≤—É—é —Å–µ—Å—Å–∏—é –ë–î.
    *   **–í–ª–∏—è–Ω–∏–µ:** –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –∞—É–¥–∏—Ç–æ–º.
    *   **–¢–µ—Å—Ç-–∫–µ–π—Å—ã:** `TC-API-SEC-10`, `TC-API-SEC-12`.

2.  **`BUG-GST-001` (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π):** –û–ø–µ—á–∞—Ç–∫–∞ –≤ –∫–æ–¥–µ (`card_ud` –≤–º–µ—Å—Ç–æ `card_uid`) –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ –ø—Ä–∏–≤—è–∑–∫–∏ –∫–∞—Ä—Ç—ã.
    *   **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—É—é –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏–≤—è–∑–∫–∏ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç—ã –∫ –≥–æ—Å—Ç—é.
    *   **–¢–µ—Å—Ç-–∫–µ–π—Å:** `TC-API-GST-06`.

3.  **`BUG-CTL-001` (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π):** –û—à–∏–±–∫–∞ `invalid keyword argument` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –æ –Ω–∞–ª–∏–≤–µ –≤ –ë–î.
    *   **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞–ª–∏–≤–æ–≤.
    *   **–¢–µ—Å—Ç-–∫–µ–π—Å:** `TC-API-CTL-05`.

4.  **`Deprecation Warning` (–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥):** –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ –º–µ—Ç–æ–¥–∞ `controller.dict()` –≤ `crud/controller_crud.py`. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∞ –Ω–∞ `controller.model_dump()` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å Pydantic V2.

#### **4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –°—Ç–∞—Ç—É—Å –¢–µ—Å—Ç-–ü–ª–∞–Ω–∞ (P1)**

| ID | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- |
| **–ú–æ–¥—É–ª—å 1: Security** | | |
| TC-API-SEC-01, 02, 06, 07, 08 | `[‚úÖ] Pass` | |
| TC-API-SEC-10, 12 | `[‚ö†Ô∏è] Blocked` | BUG-SEC-001 |
| **–ú–æ–¥—É–ª—å 2: Guest & Finance** | | |
| TC-API-GST-01, 02, 03, 05, 08, 09, 10 | `[‚úÖ] Pass` | |
| TC-API-GST-06 | `[‚ùå] Fail` | BUG-GST-001 |
| **–ú–æ–¥—É–ª—å 3: Inventory & Taps** | | |
| TC-API-INV-01, 02, 03, 05, 07, 09, 10, 11, 12 | `[‚úÖ] Pass` | |
| **–ú–æ–¥—É–ª—å 4: Controller Interaction** | | |
| TC-API-CTL-01, 02, 03, 04, 06, 07 | `[‚úÖ] Pass` | |
| TC-API-CTL-05 | `[‚ùå] Fail` | BUG-CTL-001 |

#### **5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏**

1.  **–î–ª—è –ö–æ–º–∞–Ω–¥—ã –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
    *   –ü—Ä–∏–Ω—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞: `BUG-GST-001` –∏ `BUG-CTL-001` (—Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª), –∑–∞—Ç–µ–º `BUG-SEC-001` (—Ç–∞–∫ –∫–∞–∫ –æ–Ω –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).
    *   –£—Å—Ç—Ä–∞–Ω–∏—Ç—å `Deprecation Warning` –≤ `controller_crud.py`.

2.  **–î–ª—è QA-–ö–æ–º–∞–Ω–¥—ã:**
    *   –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤ ‚Äî —É–±—Ä–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏ `@skip` –∏–∑ `.feature` —Ñ–∞–π–ª–æ–≤ –∏ –≤–≤–µ—Å—Ç–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä.
    *   –ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º **P2** –∏–∑ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä–µ—Ö –º–æ–¥—É–ª–µ–π –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è.

### 3.2. –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

*(–ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫—Ä–∞—Ç–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –æ –∫–∞—á–µ—Å—Ç–≤–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ API, –∞ —Ç–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏).*