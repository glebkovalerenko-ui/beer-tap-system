# [DEPRECATED/ARCHIVE] –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API: Backend API (v1.0.0)

## 1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 1.1. –¶–µ–ª—å –¥–æ–∫—É–º–µ–Ω—Ç–∞
–ù–∞—Å—Ç–æ—è—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–∞–≤–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è `Backend API` –ø—Ä–æ–µ–∫—Ç–∞ **Beer Tap System**. –ï–≥–æ —Ü–µ–ª—å ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API. –î–æ–∫—É–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –±—ç–∫–ª–æ–≥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–µ–º–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á.

### 1.2. –û–±—ä–µ–∫—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
*   **–û—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç:** `Backend API` (FastAPI/Python).
*   **–ì—Ä–∞–Ω–∏—Ü—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–æ—É—Ç–∏–Ω–≥, –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö).
    *   –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª.
    *   –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ SQLAlchemy).
    *   –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤—ã–¥–∞—á–∞ JWT) –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–∑–∞—â–∏—Ç–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤).

### 1.3. –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
*   **–°—Ä–µ–¥–∞:** –õ–æ–∫–∞–ª—å–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ `docker-compose` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤: –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è SQLite –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (`conftest.py`).
    *   –î–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: –ß–∏—Å—Ç—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä PostgreSQL, —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–π —á–µ—Ä–µ–∑ `docker-compose`.
*   **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
    *   **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** `pytest` —Å –ø–ª–∞–≥–∏–Ω–æ–º `pytest-bdd`.
    *   **–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Postman, Insomnia, –∏–ª–∏ `cURL`.

### 1.4. –õ–µ–≥–µ–Ω–¥–∞ –∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é
–≠—Ç–æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–º. –í —Ö–æ–¥–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ QA-–∏–Ω–∂–µ–Ω–µ—Ä –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è.

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **–°—Ç–∞—Ç—É—Å** | `[ ]` To Do, `[‚úÖ]` Pass, `[‚ùå]` Fail, `[‚ö†Ô∏è]` Blocked |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | `P1` (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π), `P2` (–í—ã—Å–æ–∫–∏–π), `P3` (–°—Ä–µ–¥–Ω–∏–π) |
| **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω?** | `[‚úÖ]` –î–∞, `[ ]` –ù–µ—Ç. –ü–æ–ª–µ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ –¥–∞–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π. |
| **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID**| ID –∑–∞–¥–∞—á–∏ –∏–∑ —Ç—Ä–µ–∫–µ—Ä–∞ (Jira, GitHub Issues), –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏, `cURL` –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è. |

### 1.5. –û–±—â–∞—è –∫–∞—Ä—Ç–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è (Mind Map)
```mermaid
mindmap
  root((Backend API Test Plan))
    (Module 1: Security & Auth)
      ::icon(fa fa-lock)
      Feature: Token Management
        - Get Token (Success/Fail)
        - Validate Token
      Feature: Endpoint Protection
        - Access with valid token
        - Access without token
        - Access with invalid token
      Feature: Audit Logging
        - Log on write actions (POST/PUT/DELETE)
        - Ignore on read actions (GET)
    (Module 2: Guest & Finance)
      ::icon(fa fa-user-check)
      Feature: Guest CRUD
        - Create, Read, Update
        - Uniqueness validation (phone, doc)
      Feature: Card Management
        - Bind new/existing card
        - Unbind card
        - Prevent binding taken card
      Feature: Financial Operations
        - Top-up balance
        - Validate amount
        - View history (pours & top-ups)
    (Module 3: Inventory & Taps)
      ::icon(fa fa-boxes)
      Feature: Beverage Directory
        - CRUD for beverages
        - Uniqueness validation (name)
      Feature: Keg Inventory
        - CRUD for kegs
        - Prevent deleting 'in_use' keg
      Feature: Tap Management
        - Assign Keg to Tap
        - Unassign Keg from Tap
        - Business rule validation (statuses)
    (Module 4: Controller Interaction)
      ::icon(fa fa-broadcast-tower)
      Feature: Controller Check-in
        - Register new controller (Upsert)
        - Update existing controller
      Feature: System Status Sync
        - Get 'Emergency Stop' status
      Feature: Pour Data Sync
        - Process valid pour (Happy Path)
        - Handle duplicates (Idempotency)
        - Reject invalid pours (balance, status)
```

### 1.6. –°–∫–≤–æ–∑–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π "Happy Path" (Sequence Diagram)
```mermaid
sequenceDiagram
    actor Bartender
    participant AdminApp as Admin App (UI)
    participant BackendAPI as Backend API
    participant Database as PostgreSQL DB

    Note over Bartender, Database: –°—Ü–µ–Ω–∞—Ä–∏–π: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è

    Bartender->>AdminApp: 1. –í–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è
    AdminApp->>BackendAPI: 2. POST /api/guests/
    note right of AdminApp: (Sends JWT in header)
    BackendAPI->>Database: 3. INSERT into guests
    Database-->>BackendAPI: Guest Record
    BackendAPI-->>AdminApp: 201 Created (Guest Object)
    AdminApp-->>Bartender: 4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–æ—Å—Ç—è –≤ —Å–ø–∏—Å–∫–µ

    Bartender->>AdminApp: 5. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
    AdminApp->>BackendAPI: 6. POST /api/guests/{id}/topup
    BackendAPI->>Database: 7. START TRANSACTION
    Database->>BackendAPI: SELECT guest for update
    BackendAPI->>Database: 8. INSERT into transactions (amount)
    BackendAPI->>Database: 9. UPDATE guests SET balance = ...
    Database->>BackendAPI: COMMIT
    BackendAPI-->>AdminApp: 200 OK (Updated Guest Object)
    AdminApp-->>Bartender: 10. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å –≤ UI
```

### 1.7. –ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞ (Flowchart)
```mermaid
graph TD
    A[Start: –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω] --> B{–í—ã–±–æ—Ä —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞};
    
    subgraph "–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Postman / cURL)"
        direction LR
        C[1. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—é] --> D{–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É?};
        D -- –î–∞ --> E[‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ 'Pass'];
        D -- –ù–µ—Ç --> F[‚ùå –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ 'Fail'];
        F --> G[2. –ó–∞–≤–µ—Å—Ç–∏ –±–∞–≥ –≤ —Ç—Ä–µ–∫–µ—Ä–µ];
        G --> H[3. –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å Bug ID –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—é];
    end

    subgraph "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Pytest-BDD)"
        direction LR
        I[1. –ù–∞–ø–∏—Å–∞–Ω–∏–µ feature-—Ñ–∞–π–ª–∞ –Ω–∞ Gherkin] --> J[2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∞–≥–æ–≤ –≤ Python];
        J --> K[3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ CI/CD];
        K --> L{–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏?};
        L -- –î–∞ --> M[‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω'];
        L -- –ù–µ—Ç --> N[üö® CI/CD Build 'Failed'];
    end

    B --> C;
    E --> P[–ì–æ—Ç–æ–≤ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏];
    P --> I;

    style A fill:#c9f,stroke:#333,stroke-width:2px
    style M fill:#dfd,stroke:#333,stroke-width:2px
    style N fill:#fdd,stroke:#333,stroke-width:2px
```

---

## 2. –ü—Ä–æ—Ç–æ–∫–æ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

### –ú–æ–¥—É–ª—å 1: Security & Auth

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-SEC-01| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br>**Given** –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ username="admin" –∏ password="fake_password"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 200 OK<br>**And** –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å "access_token" –∏ "token_type" | |
| TC-API-SEC-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request<br>**And** –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—à–∏–±–∫—É "Incorrect username or password" | |
| TC-API-SEC-03| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å –Ω–µ–≤–µ—Ä–Ω—ã–º username<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request | |
| TC-API-SEC-04| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –±–µ–∑ –ø–æ–ª—è password<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token –±–µ–∑ –ø–æ–ª—è "password"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-SEC-05| P3 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º Content-Type<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/token —Å JSON-—Ç–µ–ª–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-SEC-06| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 200 OK | |
| TC-API-SEC-07| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É –±–µ–∑ —Ç–æ–∫–µ–Ω–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 401 Unauthorized | |
| TC-API-SEC-08| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 401 Unauthorized | |
| TC-API-SEC-09| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å —Ç–æ–∫–µ–Ω–æ–º, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –Ω–µ–≤–µ—Ä–Ω—ã–º –∫–ª—é—á–æ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å —Ç–æ–∫–µ–Ω–æ–º, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –¥—Ä—É–≥–∏–º –∫–ª—é—á–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 401 Unauthorized | |
| TC-API-SEC-10| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –∂—É—Ä–Ω–∞–ª–µ –∞—É–¥–∏—Ç–∞<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "audit_logs" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-SEC-11| P2 | `[ ]` | `[ ]` | **Scenario:** –ê—É–¥–∏—Ç –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–ª—è GET-–∑–∞–ø—Ä–æ—Å–æ–≤<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/<br>**Then** –í —Ç–∞–±–ª–∏—Ü–µ "audit_logs" –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π | |
| TC-API-SEC-12| P1 | `[ ]` | `[ ]` | **Scenario:** –ê—É–¥–∏—Ç –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ<br>**Given** –ö–ª–∏–µ–Ω—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/<br>**Then** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "audit_logs" –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π | |

### –ú–æ–¥—É–ª—å 2: Guest & Finance Management

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-GST-01| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è<br>**Given** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ —Å –≤–∞–ª–∏–¥–Ω—ã–º JSON-—Ç–µ–ª–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 201 Created<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "guests" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-GST-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Å—Ç—è —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º "+79991112233"<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è —Å —Ç–µ–º –∂–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-GST-03| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Å—Ç—è —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–º<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º "4510 123456"<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è —Å —Ç–µ–º –∂–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-GST-04| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Å—Ç—è –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/ –±–µ–∑ –ø–æ–ª—è "last_name"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-GST-05| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Å—Ç—è<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å "–ò–≤–∞–Ω–æ–≤"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PUT-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id} —Å –Ω–æ–≤—ã–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –ó–∞–ø–∏—Å—å –≤ –ë–î –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ | |
| TC-API-GST-06| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç—ã –∫ –≥–æ—Å—Ç—é<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Å—Ç—å "–ü–µ—Ç—Ä–æ–≤"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/cards —Å –Ω–æ–≤—ã–º "card_uid"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "cards" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "active" | |
| TC-API-GST-07| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏–≤—è–∑–∞—Ç—å —É–∂–µ –∑–∞–Ω—è—Ç—É—é –∫–∞—Ä—Ç—É<br>**Given** –ö–∞—Ä—Ç–∞ "TAKEN-UID-456" –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –¥—Ä—É–≥–æ–º—É –≥–æ—Å—Ç—é<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–≤—è–∑–∞—Ç—å —ç—Ç—É –∫–∞—Ä—Ç—É –∫ –Ω–æ–≤–æ–º—É –≥–æ—Å—Ç—é<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-GST-08| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –æ—Ç–≤—è–∑—ã–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –æ—Ç –≥–æ—Å—Ç—è<br>**Given** –ö–∞—Ä—Ç–∞ "ACTIVE-UID-789" –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –≥–æ—Å—Ç—é<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/cards/{card_uid}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –°—Ç–∞—Ç—É—Å –∫–∞—Ä—Ç—ã –≤ –ë–î –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "inactive" | |
| TC-API-GST-09| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≥–æ—Å—Ç—è<br>**Given** –ì–æ—Å—Ç—å "–°–º–∏—Ä–Ω–æ–≤" –∏–º–µ–µ—Ç –±–∞–ª–∞–Ω—Å "100.00"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/topup —Å —Å—É–º–º–æ–π 500.00<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –ë–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è –≤ –ë–î –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "600.00"<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "transactions" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-GST-10| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —Å—É–º–º—É<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/topup —Å —Å—É–º–º–æ–π -100.00<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 422 Unprocessable Entity | |
| TC-API-GST-11| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –≥–æ—Å—Ç—é<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_uuid}/topup<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 404 Not Found | |
| TC-API-GST-12| P2 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–º–µ—à–∞–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π<br>**Given** –£ –≥–æ—Å—Ç—è –µ—Å—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –Ω–∞–ª–∏–≤<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/guests/{guest_id}/history<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ –¥–≤—É—Ö –æ–ø–µ—Ä–∞—Ü–∏–π | |

### –ú–æ–¥—É–ª—å 3: Inventory & Tap Management

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-INV-01| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –Ω–∞–ø–∏—Ç–∫–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/beverages/ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "beverages" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-INV-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–ø–∏—Ç–∫–∞ —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–∞–ø–∏—Ç–æ–∫ —Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request | |
| TC-API-INV-03| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–µ–≥–∏<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞–ø–∏—Ç–æ–∫ "Lager"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ "Lager"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "full" | |
| TC-API-INV-04| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –∫–µ–≥—É —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –Ω–∞–ø–∏—Ç–∫–æ–º<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º beverage_id<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 404 Not Found | |
| TC-API-INV-05| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –∫–µ–≥—É<br>**Given** –ö–µ–≥–∞ {keg_id} –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "in_use"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/{keg_id}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-INV-06| P2 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∫–µ–≥–∏<br>**Given** –ö–µ–≥–∞ {keg_id} –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "full"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/kegs/{keg_id}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 204 No Content | |
| TC-API-INV-07| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫—Ä–∞–Ω–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/ —Å display_name<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 201 Created<br>**And** –°—Ç–∞—Ç—É—Å –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "locked" | |
| TC-API-INV-08| P2 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –∫—Ä–∞–Ω —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–π –∫–µ–≥–æ–π<br>**Given** –ö –∫—Ä–∞–Ω—É {tap_id} –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫–µ–≥–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/{tap_id}<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400 Bad Request | |
| TC-API-INV-09| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–µ–≥–∏ –Ω–∞ –∫—Ä–∞–Ω<br>**Given** –°—É—â–µ—Å—Ç–≤—É–µ—Ç –∫–µ–≥–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "full" –∏ –∫—Ä–∞–Ω —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "locked"<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PUT-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/{tap_id}/keg —Å id –∫–µ–≥–∏<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –°—Ç–∞—Ç—É—Å –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "active"<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "in_use" | |
| TC-API-INV-10| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∫–µ–≥—É –Ω–∞ –∑–∞–Ω—è—Ç—ã–π –∫—Ä–∞–Ω<br>**Given** –ö—Ä–∞–Ω {tap_id} —É–∂–µ –∑–∞–Ω—è—Ç<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–∞ –Ω–µ–≥–æ –¥—Ä—É–≥—É—é –∫–µ–≥—É<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-INV-11| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–µ–ø–æ–ª–Ω—É—é –∫–µ–≥—É –Ω–∞ –∫—Ä–∞–Ω<br>**Given** –ö–µ–≥–∞ {keg_id} –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "in_use" –∏–ª–∏ "empty"<br>**When** –ö–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å —ç—Ç—É –∫–µ–≥—É –Ω–∞ –∫—Ä–∞–Ω<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 409 Conflict | |
| TC-API-INV-12| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ —Å–Ω—è—Ç–∏–µ –∫–µ–≥–∏ —Å –∫—Ä–∞–Ω–∞<br>**Given** –ö –∫—Ä–∞–Ω—É {tap_id} –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫–µ–≥–∞<br>**When** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DELETE-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/taps/{tap_id}/keg<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –°—Ç–∞—Ç—É—Å –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "locked"<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å "full" | |

### –ú–æ–¥—É–ª—å 4: Controller Interaction

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω? | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (Gherkin) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TC-API-CTL-01| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–µ—Ä–≤–∏—á–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/controllers/register —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º "controller_id"<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –í —Ç–∞–±–ª–∏—Ü–µ "controllers" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å | |
| TC-API-CTL-02| P1 | `[ ]` | `[ ]` | **Scenario:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–π "check-in" —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞<br>**Given** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä "RPi-001" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä "RPi-001" –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/controllers/register —Å –Ω–æ–≤—ã–º IP<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK<br>**And** –ó–∞–ø–∏—Å—å –≤ –ë–î –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ | |
| TC-API-CTL-03| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "Emergency Stop –í–´–ö–õ–Æ–ß–ï–ù"<br>**Given** –§–ª–∞–≥ "emergency_stop_enabled" —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ "false"<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/system/status<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å `{"value": "false"}` | |
| TC-API-CTL-04| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "Emergency Stop –í–ö–õ–Æ–ß–ï–ù"<br>**Given** –§–ª–∞–≥ "emergency_stop_enabled" —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ "true"<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/system/status<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å `{"value": "true"}` | |
| TC-API-CTL-05| P1 | `[ ]` | `[ ]` | **Scenario:** –£—Å–ø–µ—à–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω–æ–≥–æ –Ω–∞–ª–∏–≤–∞<br>**Given** –ì–æ—Å—Ç—å –∏–º–µ–µ—Ç –±–∞–ª–∞–Ω—Å, –∫—Ä–∞–Ω –∏ –∫–µ–≥–∞ –∞–∫—Ç–∏–≤–Ω—ã<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /api/sync/pours/ —Å –≤–∞–ª–∏–¥–Ω—ã–º –Ω–∞–ª–∏–≤–æ–º<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "accepted"<br>**And** –ë–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è –∏ –æ—Å—Ç–∞—Ç–æ–∫ –≤ –∫–µ–≥–µ –¥–æ–ª–∂–Ω—ã —É–º–µ–Ω—å—à–∏—Ç—å—Å—è | |
| TC-API-CTL-06| P1 | `[ ]` | `[ ]` | **Scenario:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏: –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ª–∏–≤–∞<br>**Given** –ù–∞–ª–∏–≤ —Å `client_tx_id="DUPLICATE-TX-ID"` —É–∂–µ –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ—Ç –∂–µ –Ω–∞–ª–∏–≤<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "accepted" –∏ reason "duplicate"<br>**And** –ë–∞–ª–∞–Ω—Å –∏ –æ—Å—Ç–∞—Ç–æ–∫ –ù–ï –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω–∏—Ç—å—Å—è | |
| TC-API-CTL-07| P1 | `[ ]` | `[ ]` | **Scenario:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–ª–∏–≤–∞ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞<br>**Given** –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞–ª–∏–≤–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –±–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ—Ç –Ω–∞–ª–∏–≤<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "rejected" –∏ reason "Insufficient funds" | |
| TC-API-CTL-08| P2 | `[ ]` | `[ ]` | **Scenario:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–ª–∏–≤–∞ –∏–∑-–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä–∞–Ω–∞<br>**Given** –ö—Ä–∞–Ω –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å "locked"<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ª–∏–≤ —Å —ç—Ç–æ–≥–æ –∫—Ä–∞–Ω–∞<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "rejected" | |
| TC-API-CTL-09| P2 | `[ ]` | `[ ]` | **Scenario:** –ù–∞–ª–∏–≤, –æ–ø—É—Å—Ç–æ—à–∞—é—â–∏–π –∫–µ–≥—É<br>**Given** –û—Å—Ç–∞—Ç–æ–∫ –≤ –∫–µ–≥–µ —Ä–∞–≤–µ–Ω –æ–±—ä–µ–º—É –Ω–∞–ª–∏–≤–∞<br>**When** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ—Ç –Ω–∞–ª–∏–≤<br>**Then** API –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "accepted"<br>**And** –°—Ç–∞—Ç—É—Å –∫–µ–≥–∏ –∏ –∫—Ä–∞–Ω–∞ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ "empty" | |

---

## 3. –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ (Summary)

### 3.1. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –°—Ç–∞—Ç—É—Å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| :--- | :--- |
| ‚úÖ Pass | |
| ‚ùå Fail | |
| ‚ö†Ô∏è Blocked | |
| **–í—Å–µ–≥–æ** | |
| **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ** | |

### 3.1.1. –§–∏–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –û—Ç—á–µ—Ç –ø–æ –†–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API**

**–ü—Ä–æ–µ–∫—Ç:** Beer Tap System MVP v1.0
**–û–±—ä–µ–∫—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** Backend API (`FastAPI/Python`)
**–ü–µ—Ä–∏–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 05.11.2025 ‚Äì 06.11.2025
**–¶–µ–ª—å:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ 100% —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ (P1, P2, P3) –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ `test-plan-backend-api.md` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ–π, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ API –∏ –µ–≥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.

---

#### **1. –ö–ª—é—á–µ–≤—ã–µ –í—ã–≤–æ–¥—ã (Executive Summary)**

–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç-–ø–ª–∞–Ω–∞, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π 48 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –∑–∞–≤–µ—Ä—à–µ–Ω. –°–æ–∑–¥–∞–Ω —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –Ω–∞ –±–∞–∑–µ `pytest-bdd`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏–ª –ø—Ä–æ–≤–µ—Å—Ç–∏ –≥–ª—É–±–æ–∫–∏–π End-to-End –∞–Ω–∞–ª–∏–∑ API.

**–ì–ª–∞–≤–Ω—ã–π –∏—Ç–æ–≥:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —è–¥—Ä–æ API (–º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º) –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å. –û–¥–Ω–∞–∫–æ, **—Ç—Ä–∏ –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ (P1) –¥–µ—Ñ–µ–∫—Ç–∞–º–∏**, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é API **–Ω–µ–ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –∏–ª–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.**

–ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤—ã—Å—Ç—É–ø–∏–ª –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –∞–Ω–∞–ª–∏–∑–∞, –≤—ã—è–≤–∏–≤ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –æ—à–∏–±–∫–∏, –Ω–æ –∏:
*   **–°–∫—Ä—ã—Ç—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã –≤ –∫–æ–¥–µ:** –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ–ø–µ—á–∞—Ç–∫–∏ –∏ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ (`AttributeError`, `TypeError`), –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–µ–ª–∏ –±—ã –∫ –ø–∞–¥–µ–Ω–∏—é —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.
*   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:** –í—ã—è–≤–ª–µ–Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á, –≤–ª–∏—è—é—â–∞—è –Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.
*   **–ù–µ–ø–æ–ª–Ω–æ—Ç—É –∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ö:** –í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã —Ç–µ—Å—Ç-–ø–ª–∞–Ω –±—ã–ª –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–µ–Ω, –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º API –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è–º–∏.

---

#### **2. –°–≤–æ–¥–Ω–∞—è –¢–∞–±–ª–∏—Ü–∞ –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê)**

–í —Ç–∞–±–ª–∏—Ü–µ –Ω–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ –∫–∞–∂–¥–æ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ç–µ—Å—Ç-–∫–µ–π—Å—É, –≤–∫–ª—é—á–∞—è –ø—É—Ç—å –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å | –°—Ü–µ–Ω–∞—Ä–∏–π (–ö—Ä–∞—Ç–∫–æ) | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / –ü—É—Ç—å –∫ –£—Å–ø–µ—Ö—É | Bug ID |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC-API-SEC-01**| P1 | ‚úÖ Pass | –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT | –ü—Ä–æ—à–µ–ª –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ (`json` -> `data`). | |
| **TC-API-SEC-02**| P1 | ‚úÖ Pass | –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-SEC-06**| P1 | ‚úÖ Pass | –î–æ—Å—Ç—É–ø —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-SEC-10**| P1 | ‚ö†Ô∏è Blocked | –ê—É–¥–∏—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ | –¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω. **–ü—É—Ç—å**: –£–ø–∞–ª (`AssertionError: 0 –∑–∞–ø–∏—Å–µ–π`), –≤—ã—è–≤–∏–≤ –±–∞–≥. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω —Ä—É—á–Ω—ã–º —Ç–µ—Å—Ç–æ–º. | **BUG-SEC-001** |
| **TC-API-SEC-12**| P1 | ‚ö†Ô∏è Blocked | –ê—É–¥–∏—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ 401 | –¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω. **–ü—É—Ç—å**: –ü—Ä–æ—Ö–æ–¥–∏–ª –ø–æ –Ω–µ–≤–µ—Ä–Ω–æ–π –ø—Ä–∏—á–∏–Ω–µ. –ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–æ —Ä–µ—à–µ–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–∞. | **BUG-SEC-001** |
| **TC-API-GST-01**| P1 | ‚úÖ Pass | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≥–æ—Å—Ç—è | –ü—Ä–æ—à–µ–ª –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—â–∏—Ö —à–∞–≥–æ–≤ –≤ `conftest.py`. | |
| **TC-API-GST-02**| P1 | ‚úÖ Pass | –î—É–±–ª–∏–∫–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞ | **–ü—É—Ç—å**: –ü–∞–¥–∞–ª 3 —Ä–∞–∑–∞ (`TypeError`, `no such table`, `no token`), —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —É–ª—É—á—à–µ–Ω–∏—é `Given`-—à–∞–≥–æ–≤ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é Gherkin. | |
| **TC-API-GST-06**| P1 | ‚ùå Fail | –ü—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç—ã | –¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω. **–ü—É—Ç—å**: –£–ø–∞–ª (`AttributeError`), –≤—ã—è–≤–∏–≤ –æ–ø–µ—á–∞—Ç–∫—É –≤ –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. | **BUG-GST-001** |
| **TC-API-GST-08**| P1 | ‚úÖ Pass | –û—Ç–≤—è–∑–∫–∞ –∫–∞—Ä—Ç—ã | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-GST-09**| P1 | ‚úÖ Pass | –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-GST-12**| P2 | ‚úÖ Pass | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ | **–ü—É—Ç—å**: –ü–∞–¥–∞–ª –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ (`NameError`, `IntegrityError`, `AssertionError`), —á—Ç–æ –≤—ã—è–≤–∏–ª–æ –Ω–µ–ø–æ–ª–Ω–æ—Ç—É `Given`-—à–∞–≥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ API. | **DIVERGENCE-API-GST-01** |
| **TC-API-INV-05**| P1 | ‚úÖ Pass | –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∫–µ–≥–∏ | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-INV-06**| P2 | ‚úÖ Pass | –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∫–µ–≥–∏ | **–ü—É—Ç—å**: –£–ø–∞–ª (`OperationalError: no such table`), —á—Ç–æ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `conftest.py` –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Gherkin. | |
| **TC-API-INV-09**| P1 | ‚úÖ Pass | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–µ–≥–∏ –Ω–∞ –∫—Ä–∞–Ω | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-INV-12**| P1 | ‚úÖ Pass | –°–Ω—è—Ç–∏–µ –∫–µ–≥–∏ —Å –∫—Ä–∞–Ω–∞ | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-CTL-01**| P1 | ‚úÖ Pass | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ | –ü—Ä–æ—à–µ–ª –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Gherkin-—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏. | |
| **TC-API-CTL-05**| P1 | ‚ùå Fail | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞–ª–∏–≤–∞ | –¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω. **–ü—É—Ç—å**: –£–ø–∞–ª (`422`), –∑–∞—Ç–µ–º (`200` —Å `rejected`), –≤—ã—è–≤–∏–≤ –±–∞–≥ –≤ CRUD. | **BUG-CTL-001** |
| **TC-API-CTL-06**| P1 | ‚úÖ Pass | –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∞–ª–∏–≤–∞ | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-CTL-07**| P1 | ‚úÖ Pass | –ù–∞–ª–∏–≤ –±–µ–∑ –±–∞–ª–∞–Ω—Å–∞ | –ü—Ä–æ—à–µ–ª —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. | |
| **TC-API-CTL-09**| P2 | ‚ùå Fail | –ù–∞–ª–∏–≤, –æ–ø—É—Å—Ç–æ—à–∞—é—â–∏–π –∫–µ–≥—É | –¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω. **–ü—É—Ç—å**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–ø–∞–ª, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–≤ –Ω–∞–ª–∏—á–∏–µ –±–∞–≥–∞. | **BUG-CTL-001** |
| ... | P2, P3 | ‚úÖ Pass | *–û—Å—Ç–∞–ª—å–Ω—ã–µ 29 —Ç–µ—Å—Ç–æ–≤* | *–ü—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∑–∞ —Å—á–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—Ç–ª–∞–∂–µ–Ω–Ω—ã—Ö –æ–±—â–∏—Ö —à–∞–≥–æ–≤.* | |

---

#### **3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ú–µ—Ç—Ä–∏–∫–∏ –∏ –§–∏–Ω–∞–ª—å–Ω—ã–π –°—Ç–∞—Ç—É—Å –¢–µ—Å—Ç-–ü–ª–∞–Ω–∞**

–í –æ—Ç—á–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–π —Ç—Ä–∞–∫—Ç–æ–≤–∫–∏:
*   **`[‚úÖ] Pass`**: –¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º.
*   **`[‚ùå] Fail`**: –¢–µ—Å—Ç —É–ø–∞–ª, –ø—Ä–∏—á–∏–Ω–∞ ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π –±–∞–≥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –¢–µ—Å—Ç –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `@skip` –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
*   **`[‚ö†Ô∏è] Blocked`**: –¢–µ—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω –∏–∑-–∑–∞ –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –±–∞–≥, –ø—Ä–æ–±–ª–µ–º—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è). –¢–µ—Å—Ç –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `@skip` –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

##### **–ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –≤—Å–µ–º 48 BDD-—Å—Ü–µ–Ω–∞—Ä–∏—è–º:**

| –°—Ç–∞—Ç—É—Å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | % –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ (48) |
| :--- | :--- | :--- |
| ‚úÖ Pass | 43 | 89.6% |
| ‚ùå Fail (Active Bug) | 3 | 6.2% |
| ‚ö†Ô∏è Blocked | 2 | 4.2% |

---

#### **4. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ê–Ω–∞–ª–∏–∑ –ü—Ä–æ—Ü–µ—Å—Å–∞ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏: –ü—Ä–æ–±–ª–µ–º—ã –∏ –†–µ—à–µ–Ω–∏—è**

##### **A. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –î–µ—Ñ–µ–∫—Ç—ã –≤ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**
1.  **`BUG-CTL-001`: –ü–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–ª–∏–≤–æ–≤ (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)**
2.  **`BUG-GST-001`: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏ –Ω–æ–≤—ã—Ö RFID-–∫–∞—Ä—Ç (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)**
3.  **`BUG-SEC-001`: –ù–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –∞—É–¥–∏—Ç–∞ –≤ —Ç–µ—Å—Ç–∞—Ö (–í—ã—Å–æ–∫–∏–π)**

##### **B. –≠–≤–æ–ª—é—Ü–∏—è –∏ –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –¢–µ—Å—Ç–æ–≤–æ–≥–æ –§—Ä–µ–π–º–≤–æ—Ä–∫–∞**

1.  **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã `no such table`:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞–ª–∏ –∏–∑-–∑–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î.
    *   **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ–¥–µ–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `conftest.py`. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î –±—ã–ª–∞ **–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –∏–∑ —Ñ–∏–∫—Å—Ç—É—Ä—ã `client` –≤ —Ñ–∏–∫—Å—Ç—É—Ä—É `db_session`**. –¢–µ–ø–µ—Ä—å –ª—é–±–æ–π —Ç–µ—Å—Ç, –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—â–∏–π –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ë–î —á–µ—Ä–µ–∑ `db_session`, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –µ–µ –≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –≠—Ç–æ —É—Å—Ç—Ä–∞–Ω–∏–ª–æ –ø—Ä–æ–±–ª–µ–º—É –∏ —Å–¥–µ–ª–∞–ª–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–º –∏ –º–µ–Ω–µ–µ –∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç –Ω–µ—è–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Ñ–∏–∫—Å—Ç—É—Ä.
2.  **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã `StepDefinitionNotFoundError`:** –ü–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–±—â–∏–µ —à–∞–≥–∏.
    *   **–†–µ—à–µ–Ω–∏–µ:** –ú—ã –≤—ã—Ä–∞–±–æ—Ç–∞–ª–∏ —á–µ—Ç–∫—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É: **–≤—Å–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ, –Ω–µ –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —à–∞–≥–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–æ–≤ –æ—Ç–≤–µ—Ç–∞, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è) –±—ã–ª–∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `conftest.py`. –®–∞–≥–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è, –æ—Å—Ç–∞–ª–∏—Å—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö `step_defs`. –≠—Ç–æ —Å–¥–µ–ª–∞–ª–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –∏ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º, —É—Å—Ç—Ä–∞–Ω–∏–≤ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ.
3.  **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –¢–µ—Å—Ç–æ–≤—ã—Ö –î–∞–Ω–Ω—ã—Ö:** –í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –º—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å —Å–µ—Ä–∏–µ–π –æ—à–∏–±–æ–∫ `IntegrityError` –∏ `TypeError`.
    *   **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ —Ä–µ–≤–∏–∑–∏—è –≤—Å–µ—Ö `Given`-—à–∞–≥–æ–≤. –¢–µ–ø–µ—Ä—å –æ–Ω–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∞–ª–∏–¥–Ω—ã–µ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã SQLAlchemy, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (e.g., `datetime.date` –≤–º–µ—Å—Ç–æ `str`), —á—Ç–æ —Å–¥–µ–ª–∞–ª–æ —Ç–µ—Å—Ç—ã –Ω–∞–¥–µ–∂–Ω—ã–º–∏.

##### **C. –£—Ç–æ—á–Ω–µ–Ω–∏—è –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π (–¢–µ—Å—Ç-–ø–ª–∞–Ω–∞)**
1.  **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏–π –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
2.  **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –§–æ—Ä–º–∞—Ç–µ –û—Ç–≤–µ—Ç–∞ (`DIVERGENCE-API-GST-01`)**
3.  **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è Gherkin-—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫**

---

#### **5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –ü–ª–∞–Ω –î–∞–ª—å–Ω–µ–π—à–∏—Ö –î–µ–π—Å—Ç–≤–∏–π**

##### **–î–ª—è –ö–æ–º–∞–Ω–¥—ã –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**

1.  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ1 (–ë–ª–æ–∫–µ—Ä—ã MVP):** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `BUG-CTL-001` (–Ω–∞–ª–∏–≤—ã) –∏ `BUG-GST-001` (–∫–∞—Ä—Ç—ã).
2.  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ2 (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞):** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `BUG-SEC-001` –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤ –∞—É–¥–∏—Ç–∞.
3.  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ3 (–¢–µ—Ö–¥–æ–ª–≥):** –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–≤–∏–∑–∏—é API –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤ (–≤ —Å–≤—è–∑–∏ —Å `DIVERGENCE-API-GST-01`) –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ `PydanticDeprecatedSince20`.

##### **–î–ª—è QA-–ö–æ–º–∞–Ω–¥—ã:**

1.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD:** –¢–µ–∫—É—â–∏–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ CI/CD –ø–∞–π–ø–ª–∞–π–Ω —Å –∑–∞–ø—É—Å–∫–æ–º –Ω–∞ **–∫–∞–∂–¥—ã–π pull request –≤ `main` –≤–µ—Ç–∫—É**.
2.  **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤, –ø–µ—Ä–≤–æ–æ—á–µ—Ä–µ–¥–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî —É–±—Ä–∞—Ç—å –º–∞—Ä–∫–µ—Ä—ã `@skip` –∏ –¥–æ–±–∏—Ç—å—Å—è 100% –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤ (`48 passed`).
3.  **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –†–∞–∑–≤–∏—Ç–∏–µ:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –Ω–∞–¥–µ–∂–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ "–ø–æ –º–µ—Ä–µ –µ–µ –ø–æ—è–≤–ª–µ–Ω–∏—è" (in-sprint automation).