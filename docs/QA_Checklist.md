# Чек-лист для сквозного тестирования MVP "Beer Tap System"

**Версия:** 1.1
**Дата:** 2025-10-10
**Тестировщик:** _________________

---

### **Сценарий 1: "Счастливый путь" - Полный цикл обслуживания гостя**

| Шаг | Действие | Ожидаемый результат | Статус |
| :-- | :--- | :--- | :---: |
| 1.1 | **[Бармен]** Открыть админ-панель (`http://localhost/`). | Интерфейс загружен, отображается главная страница. | ☐ |
| 1.2 | **[Бармен]** Перейти на страницу "Гости". | Отображается (возможно, пустая) таблица гостей. | ☐ |
| 1.3 | **[Бармен]** Нажать "Добавить гостя". Ввести валидные данные нового гостя "Иван Тестеров". | Форма отправляется, в списке появляется "Иван Тестеров". | ☐ |
| 1.4 | **[Бармен]** (MVP-эмуляция) Вручную пополнить баланс гостя (пока без UI). | *Техническая проверка: баланс в БД изменился.* | ☐ |
| 1.5 | **[Гость]** Приложить RFID-карту к считывателю на RPi. | В консоли RPi отображается UID карты. | ☐ |
| 1.6 | **[Гость]** Нажать "Enter" для эмуляции налива 250 мл. | Контроллер отображает успешное сохранение транзакции в локальную БД. | ☐ |
| 1.7 | **[Система]** Подождать интервал синхронизации (15 сек). | В логах RPi появляется сообщение об успешной синхронизации. В логах бэкенда виден POST-запрос. | ☐ |
| 1.8 | **[Бармен]** Обновить страницу "Гости" в админ-панели. | *Техническая проверка: баланс гостя в БД уменьшился на стоимость 250 мл.* | ☐ |
| 1.9 | **[Система]** Проверить БД PostgreSQL. | В таблице `pours` появилась запись о наливе с корректными `client_tx_id`, `card_uid` и объемом. | ☐ |
| 1.10| **[Система]** Проверить БД SQLite на RPi. | Статус соответствующей транзакции изменился с `new` на `confirmed`. | ☐ |

### **Сценарий 2: Обработка нештатных ситуаций**

| Шаг | Действие | Ожидаемый результат | Статус |
| :-- | :--- | :--- | :---: |
| 2.1 | **[Бармен]** Попытаться создать гостя с уже существующим `id_document`. | API возвращает ошибку 409 Conflict, в интерфейсе отображается сообщение об ошибке. | ☐ |
| 2.2 | **[Система]** Отключить RPi от сети (выключить Wi-Fi). | Контроллер продолжает работать в штатном режиме. | ☐ |
| 2.3 | **[Гость]** Приложить карту и эмулировать 2 налива. | Обе транзакции успешно сохраняются в локальную SQLite со статусом `new`. | ☐ |
| 2.4 | **[Система]** Включить RPi обратно в сеть. | Через 15-30 секунд обе транзакции успешно синхронизируются с сервером. В PostgreSQL появляются 2 новые записи. | ☐ |
| 2.5 | **[Гость]** Приложить карту, нажать Enter, и во время "налива" убрать карту. | Операция прерывается, в консоли RPi сообщение об отмене. Транзакция **НЕ** сохраняется в SQLite. | ☐ |

### **Сценарий 3: Граничные условия и проверка ввода**

| Шаг | Действие | Ожидаемый результат | Статус |
| :-- | :--- | :--- | :---: |
| 3.1 | **[Бармен]** Попытаться создать гостя с пустыми полями (имя, номер документа). | API возвращает ошибку 422 Unprocessable Entity, в интерфейсе подсвечиваются незаполненные обязательные поля. | ☐ |
| 3.2 | **[Бармен]** Попытаться создать гостя с заведомо некорректной датой рождения (например, из будущего). | Система валидации на бэкенде и фронтенде не пропускает такие данные, выдается понятная ошибка. | ☐ |
| 3.3 | **[Гость]** (Техническая проверка) Попытаться отправить на сервер транзакцию с нулевым или отрицательным объемом налива. | API возвращает ошибку валидации (например, 400 Bad Request), транзакция не создается. | ☐ |
| 3.4 | **[Система]** Проверить, что происходит с транзакцией, если в момент синхронизации сервер недоступен (503 Service Unavailable). | Контроллер на RPi должен получить ошибку, но **не менять** статус транзакции с `new` на `confirmed`. Он должен повторить попытку синхронизации в следующем цикле. | ☐ |